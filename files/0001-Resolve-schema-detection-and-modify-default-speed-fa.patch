From 0a92a57bd01f1263052a65be92d41bb6738e5824 Mon Sep 17 00:00:00 2001
From: Joshua Strobl <joshua@stroblindustries.com>
Date: Tue, 9 May 2017 16:54:17 +0300
Subject: [PATCH 1/1] Resolve schema detection and modify default speed factor.

---
 ...l.extensions.net.gfxmonk.impatience.gschema.xml |  2 +-
 impatience/settings.js                             | 22 +---------------------
 2 files changed, 2 insertions(+), 22 deletions(-)

diff --git a/impatience/schemas/org.gnome.shell.extensions.net.gfxmonk.impatience.gschema.xml b/impatience/schemas/org.gnome.shell.extensions.net.gfxmonk.impatience.gschema.xml
index ffd0c93..064cbb6 100644
--- a/impatience/schemas/org.gnome.shell.extensions.net.gfxmonk.impatience.gschema.xml
+++ b/impatience/schemas/org.gnome.shell.extensions.net.gfxmonk.impatience.gschema.xml
@@ -2,7 +2,7 @@
 <schemalist>
 	<schema id="org.gnome.shell.extensions.net.gfxmonk.impatience" path="/org/gnome/shell/extensions/net/gfxmonk/impatience/">
 		<key type="d" name="speed-factor">
-			<default>0.75</default>
+			<default>0.50</default>
 			<summary>speed factor</summary>
 			<description/>
 		</key>
diff --git a/impatience/settings.js b/impatience/settings.js
index c4f6815..2266918 100644
--- a/impatience/settings.js
+++ b/impatience/settings.js
@@ -5,27 +5,7 @@ const Extension = ExtensionUtils.getCurrentExtension();
 const SCHEMA_PATH = 'org.gnome.shell.extensions.net.gfxmonk.impatience';
 
 function get_local_gsettings(schema_path) {
-	const GioSSS = Gio.SettingsSchemaSource;
-
-	let schemaDir = Extension.dir.get_child('schemas');
-
-	let schemaSource = GioSSS.get_default();
-	if (schemaDir.query_exists(null)) {
-		schemaSource = GioSSS.new_from_directory(
-			schemaDir.get_path(),
-			schemaSource,
-			false);
-	}
-
-	let schemaObj = schemaSource.lookup(schema_path, true);
-	if (!schemaObj) {
-		throw new Error(
-			'Schema ' + schema_path +
-			' could not be found for extension ' +
-			Extension.metadata.uuid
-		);
-	}
-	return new Gio.Settings({ settings_schema: schemaObj });
+	return new Gio.Settings({ schema_id: SCHEMA_PATH });
 };
 
 function Prefs() {
-- 
2.12.2

